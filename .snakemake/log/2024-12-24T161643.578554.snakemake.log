Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cluster nodes: 100
Job counts:
	count	jobs
	1	all_subset
	1	extract_sample_ids
	6	filter_remapped_reads
	6	find_intersecting_snps
	6	merge
	6	remap_wasp_reads
	6	rmDupWASP
	6	run_ataqv_subset
	1	snp2h5
	39

[Tue Dec 24 16:16:45 2024]
rule extract_sample_ids:
    input: output/geno/pbs_geno_other/CTL_samples_with_replacements.txt, output/geno/fnf_geno_other/FNF_samples_with_replacements.txt
    output: output/wasp/pbs_subset_sample_ids.txt, output/wasp/fnf_subset_sample_ids.txt
    log: output/logs/extract_sample_ids_pbs_subset.log, output/logs/extract_sample_ids_fnf_subset.log
    jobid: 87



        # Extract the first column for PBS sample IDs
        cut -d' ' -f1 output/geno/pbs_geno_other/CTL_samples_with_replacements.txt > output/wasp/pbs_subset_sample_ids.txt 2> output/logs/extract_sample_ids_pbs_subset.log

        # Extract the first column for FNF sample IDs
        cut -d' ' -f1 output/geno/fnf_geno_other/FNF_samples_with_replacements.txt > output/wasp/fnf_subset_sample_ids.txt 2> output/logs/extract_sample_ids_fnf_subset.log
        
Submitted job 87 with external jobid '56368558'.
[Tue Dec 24 16:17:17 2024]
Finished job 87.
1 of 39 steps (3%) done

[Tue Dec 24 16:17:22 2024]
rule snp2h5:
    input: output/wasp/pbs_subset_sample_ids.txt, output/wasp/fnf_subset_sample_ids.txt
    output: output/wasp/pbs_rep/haplotypes.h5, output/wasp/pbs_rep/snp_index.h5, output/wasp/pbs_rep/snp_tab.h5, output/wasp/fnf_rep/haplotypes.h5, output/wasp/fnf_rep/snp_index.h5, output/wasp/fnf_rep/snp_tab.h5
    log: output/logs/pbs_rep_snp2h5.err, output/logs/fnf_rep_snp2h5.err
    jobid: 86


        module add wasp/2023-02
        mkdir -p output/wasp/pbs_rep output/wasp/fnf_rep

        # Process PBS VCF
        /nas/longleaf/rhel8/apps/wasp/2023-02/WASP/snp2h5/snp2h5         --chrom /users/s/e/seyoun/Ref/genome/chrsize.txt         --format vcf         --haplotype output/wasp/pbs_rep/haplotypes.h5         --snp_index output/wasp/pbs_rep/snp_index.h5         --snp_tab output/wasp/pbs_rep/snp_tab.h5         output/geno/pbs_geno_other/wasp_vcf/chr*.pbs.rename.vcf.gz 2> output/logs/pbs_rep_snp2h5.err

        # Process FNF VCF
        /nas/longleaf/rhel8/apps/wasp/2023-02/WASP/snp2h5/snp2h5         --chrom /users/s/e/seyoun/Ref/genome/chrsize.txt         --format vcf         --haplotype output/wasp/fnf_rep/haplotypes.h5         --snp_index output/wasp/fnf_rep/snp_index.h5         --snp_tab output/wasp/fnf_rep/snp_tab.h5         output/geno/fnf_geno_other/wasp_vcf/chr*.fnf.rename.vcf.gz 2> output/logs/fnf_rep_snp2h5.err
        
Submitted job 86 with external jobid '56368560'.
[Tue Dec 24 17:33:20 2024]
Finished job 86.
2 of 39 steps (5%) done

[Tue Dec 24 17:33:25 2024]
rule find_intersecting_snps:
    input: output/align/CQTL_AM7754_FNF_Ankle_replicate_RG.bam, output/wasp/pbs_rep/snp_tab.h5, output/wasp/pbs_rep/snp_index.h5, output/wasp/pbs_rep/haplotypes.h5, output/wasp/fnf_rep/snp_tab.h5, output/wasp/fnf_rep/snp_index.h5, output/wasp/fnf_rep/haplotypes.h5, output/wasp/pbs_subset_sample_ids.txt, output/wasp/fnf_subset_sample_ids.txt
    output: output/wasp/filter_remapped_reads/CQTL_AM7754_FNF_Ankle_replicate_filtered.remap.fq1.gz, output/wasp/filter_remapped_reads/CQTL_AM7754_FNF_Ankle_replicate_filtered.remap.fq2.gz, output/wasp/filter_remapped_reads/CQTL_AM7754_FNF_Ankle_replicate_filtered.to.remap.bam, output/wasp/filter_remapped_reads/CQTL_AM7754_FNF_Ankle_replicate_filtered.keep.bam
    log: output/logs/find_intersecting_snps_pbs_rep_CQTL_AM7754_FNF_Ankle_replicate.err
    jobid: 70
    wildcards: sampleName=CQTL_AM7754_FNF_Ankle_replicate
    threads: 4


        module add wasp/2023-02

        mkdir -p output/wasp/filter_remapped_reads

                if [[ "CQTL_AM7754_FNF_Ankle_replicate" == *"CTL"* ]]; then
            snp_tab=output/wasp/pbs_rep/snp_tab.h5
            snp_index=output/wasp/pbs_rep/snp_index.h5
            haplotypes=output/wasp/pbs_rep/haplotypes.h5
            sample_id=output/wasp/pbs_subset_sample_ids.txt
        elif [[ "CQTL_AM7754_FNF_Ankle_replicate" == *"FNF"* ]]; then
            snp_tab=output/wasp/fnf_rep/snp_tab.h5
            snp_index=output/wasp/fnf_rep/snp_index.h5
            haplotypes=output/wasp/fnf_rep/haplotypes.h5
            sample_id=output/wasp/fnf_subset_sample_ids.txt
        else
            echo "Error: Sample type not recognized in CQTL_AM7754_FNF_Ankle_replicate"
            exit 1
        fi

        # Add error checking here
        if [[ -z "$snp_tab" ]]; then
            echo "Error: snp_tab not set"
            exit 1
        fi
        if [[ -z "$snp_index" ]]; then
            echo "Error: snp_index not set"
            exit 1
        fi
        if [[ -z "$haplotypes" ]]; then
            echo "Error: haplotypes not set"
            exit 1
        fi
        if [[ -z "$sample_id" ]]; then
            echo "Error: sample_id not set"
            exit 1
        fi

        # Then run WASP command
        python /nas/longleaf/rhel8/apps/wasp/2023-02/WASP/mapping/find_intersecting_snps.py         --is_paired_end         --is_sorted         --output_dir output/wasp/filter_remapped_reads         --snp_tab $snp_tab         --snp_index $snp_index         --haplotype $haplotypes         --samples $sample_id         output/align/CQTL_AM7754_FNF_Ankle_replicate_RG.bam 2> output/logs/find_intersecting_snps_pbs_rep_CQTL_AM7754_FNF_Ankle_replicate.err

        
Submitted job 70 with external jobid '56371142'.

[Tue Dec 24 17:33:30 2024]
rule find_intersecting_snps:
    input: output/align/CQTL_AM7755_FNF_Ankle_replicate_RG.bam, output/wasp/pbs_rep/snp_tab.h5, output/wasp/pbs_rep/snp_index.h5, output/wasp/pbs_rep/haplotypes.h5, output/wasp/fnf_rep/snp_tab.h5, output/wasp/fnf_rep/snp_index.h5, output/wasp/fnf_rep/haplotypes.h5, output/wasp/pbs_subset_sample_ids.txt, output/wasp/fnf_subset_sample_ids.txt
    output: output/wasp/filter_remapped_reads/CQTL_AM7755_FNF_Ankle_replicate_filtered.remap.fq1.gz, output/wasp/filter_remapped_reads/CQTL_AM7755_FNF_Ankle_replicate_filtered.remap.fq2.gz, output/wasp/filter_remapped_reads/CQTL_AM7755_FNF_Ankle_replicate_filtered.to.remap.bam, output/wasp/filter_remapped_reads/CQTL_AM7755_FNF_Ankle_replicate_filtered.keep.bam
    log: output/logs/find_intersecting_snps_pbs_rep_CQTL_AM7755_FNF_Ankle_replicate.err
    jobid: 72
    wildcards: sampleName=CQTL_AM7755_FNF_Ankle_replicate
    threads: 4


        module add wasp/2023-02

        mkdir -p output/wasp/filter_remapped_reads

                if [[ "CQTL_AM7755_FNF_Ankle_replicate" == *"CTL"* ]]; then
            snp_tab=output/wasp/pbs_rep/snp_tab.h5
            snp_index=output/wasp/pbs_rep/snp_index.h5
            haplotypes=output/wasp/pbs_rep/haplotypes.h5
            sample_id=output/wasp/pbs_subset_sample_ids.txt
        elif [[ "CQTL_AM7755_FNF_Ankle_replicate" == *"FNF"* ]]; then
            snp_tab=output/wasp/fnf_rep/snp_tab.h5
            snp_index=output/wasp/fnf_rep/snp_index.h5
            haplotypes=output/wasp/fnf_rep/haplotypes.h5
            sample_id=output/wasp/fnf_subset_sample_ids.txt
        else
            echo "Error: Sample type not recognized in CQTL_AM7755_FNF_Ankle_replicate"
            exit 1
        fi

        # Add error checking here
        if [[ -z "$snp_tab" ]]; then
            echo "Error: snp_tab not set"
            exit 1
        fi
        if [[ -z "$snp_index" ]]; then
            echo "Error: snp_index not set"
            exit 1
        fi
        if [[ -z "$haplotypes" ]]; then
            echo "Error: haplotypes not set"
            exit 1
        fi
        if [[ -z "$sample_id" ]]; then
            echo "Error: sample_id not set"
            exit 1
        fi

        # Then run WASP command
        python /nas/longleaf/rhel8/apps/wasp/2023-02/WASP/mapping/find_intersecting_snps.py         --is_paired_end         --is_sorted         --output_dir output/wasp/filter_remapped_reads         --snp_tab $snp_tab         --snp_index $snp_index         --haplotype $haplotypes         --samples $sample_id         output/align/CQTL_AM7755_FNF_Ankle_replicate_RG.bam 2> output/logs/find_intersecting_snps_pbs_rep_CQTL_AM7755_FNF_Ankle_replicate.err

        
Submitted job 72 with external jobid '56371143'.

[Tue Dec 24 17:33:35 2024]
rule find_intersecting_snps:
    input: output/align/CQTL_AM7778FE_CTL_Femur_1_RG.bam, output/wasp/pbs_rep/snp_tab.h5, output/wasp/pbs_rep/snp_index.h5, output/wasp/pbs_rep/haplotypes.h5, output/wasp/fnf_rep/snp_tab.h5, output/wasp/fnf_rep/snp_index.h5, output/wasp/fnf_rep/haplotypes.h5, output/wasp/pbs_subset_sample_ids.txt, output/wasp/fnf_subset_sample_ids.txt
    output: output/wasp/filter_remapped_reads/CQTL_AM7778FE_CTL_Femur_1_filtered.remap.fq1.gz, output/wasp/filter_remapped_reads/CQTL_AM7778FE_CTL_Femur_1_filtered.remap.fq2.gz, output/wasp/filter_remapped_reads/CQTL_AM7778FE_CTL_Femur_1_filtered.to.remap.bam, output/wasp/filter_remapped_reads/CQTL_AM7778FE_CTL_Femur_1_filtered.keep.bam
    log: output/logs/find_intersecting_snps_pbs_rep_CQTL_AM7778FE_CTL_Femur_1.err
    jobid: 74
    wildcards: sampleName=CQTL_AM7778FE_CTL_Femur_1
    threads: 4


        module add wasp/2023-02

        mkdir -p output/wasp/filter_remapped_reads

                if [[ "CQTL_AM7778FE_CTL_Femur_1" == *"CTL"* ]]; then
            snp_tab=output/wasp/pbs_rep/snp_tab.h5
            snp_index=output/wasp/pbs_rep/snp_index.h5
            haplotypes=output/wasp/pbs_rep/haplotypes.h5
            sample_id=output/wasp/pbs_subset_sample_ids.txt
        elif [[ "CQTL_AM7778FE_CTL_Femur_1" == *"FNF"* ]]; then
            snp_tab=output/wasp/fnf_rep/snp_tab.h5
            snp_index=output/wasp/fnf_rep/snp_index.h5
            haplotypes=output/wasp/fnf_rep/haplotypes.h5
            sample_id=output/wasp/fnf_subset_sample_ids.txt
        else
            echo "Error: Sample type not recognized in CQTL_AM7778FE_CTL_Femur_1"
            exit 1
        fi

        # Add error checking here
        if [[ -z "$snp_tab" ]]; then
            echo "Error: snp_tab not set"
            exit 1
        fi
        if [[ -z "$snp_index" ]]; then
            echo "Error: snp_index not set"
            exit 1
        fi
        if [[ -z "$haplotypes" ]]; then
            echo "Error: haplotypes not set"
            exit 1
        fi
        if [[ -z "$sample_id" ]]; then
            echo "Error: sample_id not set"
            exit 1
        fi

        # Then run WASP command
        python /nas/longleaf/rhel8/apps/wasp/2023-02/WASP/mapping/find_intersecting_snps.py         --is_paired_end         --is_sorted         --output_dir output/wasp/filter_remapped_reads         --snp_tab $snp_tab         --snp_index $snp_index         --haplotype $haplotypes         --samples $sample_id         output/align/CQTL_AM7778FE_CTL_Femur_1_RG.bam 2> output/logs/find_intersecting_snps_pbs_rep_CQTL_AM7778FE_CTL_Femur_1.err

        
Submitted job 74 with external jobid '56371144'.

[Tue Dec 24 17:33:40 2024]
rule find_intersecting_snps:
    input: output/align/CQTL_AM7778FE_FNF_Femur_1_RG.bam, output/wasp/pbs_rep/snp_tab.h5, output/wasp/pbs_rep/snp_index.h5, output/wasp/pbs_rep/haplotypes.h5, output/wasp/fnf_rep/snp_tab.h5, output/wasp/fnf_rep/snp_index.h5, output/wasp/fnf_rep/haplotypes.h5, output/wasp/pbs_subset_sample_ids.txt, output/wasp/fnf_subset_sample_ids.txt
    output: output/wasp/filter_remapped_reads/CQTL_AM7778FE_FNF_Femur_1_filtered.remap.fq1.gz, output/wasp/filter_remapped_reads/CQTL_AM7778FE_FNF_Femur_1_filtered.remap.fq2.gz, output/wasp/filter_remapped_reads/CQTL_AM7778FE_FNF_Femur_1_filtered.to.remap.bam, output/wasp/filter_remapped_reads/CQTL_AM7778FE_FNF_Femur_1_filtered.keep.bam
    log: output/logs/find_intersecting_snps_pbs_rep_CQTL_AM7778FE_FNF_Femur_1.err
    jobid: 68
    wildcards: sampleName=CQTL_AM7778FE_FNF_Femur_1
    threads: 4


        module add wasp/2023-02

        mkdir -p output/wasp/filter_remapped_reads

                if [[ "CQTL_AM7778FE_FNF_Femur_1" == *"CTL"* ]]; then
            snp_tab=output/wasp/pbs_rep/snp_tab.h5
            snp_index=output/wasp/pbs_rep/snp_index.h5
            haplotypes=output/wasp/pbs_rep/haplotypes.h5
            sample_id=output/wasp/pbs_subset_sample_ids.txt
        elif [[ "CQTL_AM7778FE_FNF_Femur_1" == *"FNF"* ]]; then
            snp_tab=output/wasp/fnf_rep/snp_tab.h5
            snp_index=output/wasp/fnf_rep/snp_index.h5
            haplotypes=output/wasp/fnf_rep/haplotypes.h5
            sample_id=output/wasp/fnf_subset_sample_ids.txt
        else
            echo "Error: Sample type not recognized in CQTL_AM7778FE_FNF_Femur_1"
            exit 1
        fi

        # Add error checking here
        if [[ -z "$snp_tab" ]]; then
            echo "Error: snp_tab not set"
            exit 1
        fi
        if [[ -z "$snp_index" ]]; then
            echo "Error: snp_index not set"
            exit 1
        fi
        if [[ -z "$haplotypes" ]]; then
            echo "Error: haplotypes not set"
            exit 1
        fi
        if [[ -z "$sample_id" ]]; then
            echo "Error: sample_id not set"
            exit 1
        fi

        # Then run WASP command
        python /nas/longleaf/rhel8/apps/wasp/2023-02/WASP/mapping/find_intersecting_snps.py         --is_paired_end         --is_sorted         --output_dir output/wasp/filter_remapped_reads         --snp_tab $snp_tab         --snp_index $snp_index         --haplotype $haplotypes         --samples $sample_id         output/align/CQTL_AM7778FE_FNF_Femur_1_RG.bam 2> output/logs/find_intersecting_snps_pbs_rep_CQTL_AM7778FE_FNF_Femur_1.err

        
Submitted job 68 with external jobid '56371145'.

[Tue Dec 24 17:33:46 2024]
rule find_intersecting_snps:
    input: output/align/CQTL_AM7754_CTL_Ankle_replicate_RG.bam, output/wasp/pbs_rep/snp_tab.h5, output/wasp/pbs_rep/snp_index.h5, output/wasp/pbs_rep/haplotypes.h5, output/wasp/fnf_rep/snp_tab.h5, output/wasp/fnf_rep/snp_index.h5, output/wasp/fnf_rep/haplotypes.h5, output/wasp/pbs_subset_sample_ids.txt, output/wasp/fnf_subset_sample_ids.txt
    output: output/wasp/filter_remapped_reads/CQTL_AM7754_CTL_Ankle_replicate_filtered.remap.fq1.gz, output/wasp/filter_remapped_reads/CQTL_AM7754_CTL_Ankle_replicate_filtered.remap.fq2.gz, output/wasp/filter_remapped_reads/CQTL_AM7754_CTL_Ankle_replicate_filtered.to.remap.bam, output/wasp/filter_remapped_reads/CQTL_AM7754_CTL_Ankle_replicate_filtered.keep.bam
    log: output/logs/find_intersecting_snps_pbs_rep_CQTL_AM7754_CTL_Ankle_replicate.err
    jobid: 76
    wildcards: sampleName=CQTL_AM7754_CTL_Ankle_replicate
    threads: 4


        module add wasp/2023-02

        mkdir -p output/wasp/filter_remapped_reads

                if [[ "CQTL_AM7754_CTL_Ankle_replicate" == *"CTL"* ]]; then
            snp_tab=output/wasp/pbs_rep/snp_tab.h5
            snp_index=output/wasp/pbs_rep/snp_index.h5
            haplotypes=output/wasp/pbs_rep/haplotypes.h5
            sample_id=output/wasp/pbs_subset_sample_ids.txt
        elif [[ "CQTL_AM7754_CTL_Ankle_replicate" == *"FNF"* ]]; then
            snp_tab=output/wasp/fnf_rep/snp_tab.h5
            snp_index=output/wasp/fnf_rep/snp_index.h5
            haplotypes=output/wasp/fnf_rep/haplotypes.h5
            sample_id=output/wasp/fnf_subset_sample_ids.txt
        else
            echo "Error: Sample type not recognized in CQTL_AM7754_CTL_Ankle_replicate"
            exit 1
        fi

        # Add error checking here
        if [[ -z "$snp_tab" ]]; then
            echo "Error: snp_tab not set"
            exit 1
        fi
        if [[ -z "$snp_index" ]]; then
            echo "Error: snp_index not set"
            exit 1
        fi
        if [[ -z "$haplotypes" ]]; then
            echo "Error: haplotypes not set"
            exit 1
        fi
        if [[ -z "$sample_id" ]]; then
            echo "Error: sample_id not set"
            exit 1
        fi

        # Then run WASP command
        python /nas/longleaf/rhel8/apps/wasp/2023-02/WASP/mapping/find_intersecting_snps.py         --is_paired_end         --is_sorted         --output_dir output/wasp/filter_remapped_reads         --snp_tab $snp_tab         --snp_index $snp_index         --haplotype $haplotypes         --samples $sample_id         output/align/CQTL_AM7754_CTL_Ankle_replicate_RG.bam 2> output/logs/find_intersecting_snps_pbs_rep_CQTL_AM7754_CTL_Ankle_replicate.err

        
Submitted job 76 with external jobid '56371146'.

[Tue Dec 24 17:33:52 2024]
rule find_intersecting_snps:
    input: output/align/CQTL_AM7755_CTL_Ankle_replicate_RG.bam, output/wasp/pbs_rep/snp_tab.h5, output/wasp/pbs_rep/snp_index.h5, output/wasp/pbs_rep/haplotypes.h5, output/wasp/fnf_rep/snp_tab.h5, output/wasp/fnf_rep/snp_index.h5, output/wasp/fnf_rep/haplotypes.h5, output/wasp/pbs_subset_sample_ids.txt, output/wasp/fnf_subset_sample_ids.txt
    output: output/wasp/filter_remapped_reads/CQTL_AM7755_CTL_Ankle_replicate_filtered.remap.fq1.gz, output/wasp/filter_remapped_reads/CQTL_AM7755_CTL_Ankle_replicate_filtered.remap.fq2.gz, output/wasp/filter_remapped_reads/CQTL_AM7755_CTL_Ankle_replicate_filtered.to.remap.bam, output/wasp/filter_remapped_reads/CQTL_AM7755_CTL_Ankle_replicate_filtered.keep.bam
    log: output/logs/find_intersecting_snps_pbs_rep_CQTL_AM7755_CTL_Ankle_replicate.err
    jobid: 78
    wildcards: sampleName=CQTL_AM7755_CTL_Ankle_replicate
    threads: 4


        module add wasp/2023-02

        mkdir -p output/wasp/filter_remapped_reads

                if [[ "CQTL_AM7755_CTL_Ankle_replicate" == *"CTL"* ]]; then
            snp_tab=output/wasp/pbs_rep/snp_tab.h5
            snp_index=output/wasp/pbs_rep/snp_index.h5
            haplotypes=output/wasp/pbs_rep/haplotypes.h5
            sample_id=output/wasp/pbs_subset_sample_ids.txt
        elif [[ "CQTL_AM7755_CTL_Ankle_replicate" == *"FNF"* ]]; then
            snp_tab=output/wasp/fnf_rep/snp_tab.h5
            snp_index=output/wasp/fnf_rep/snp_index.h5
            haplotypes=output/wasp/fnf_rep/haplotypes.h5
            sample_id=output/wasp/fnf_subset_sample_ids.txt
        else
            echo "Error: Sample type not recognized in CQTL_AM7755_CTL_Ankle_replicate"
            exit 1
        fi

        # Add error checking here
        if [[ -z "$snp_tab" ]]; then
            echo "Error: snp_tab not set"
            exit 1
        fi
        if [[ -z "$snp_index" ]]; then
            echo "Error: snp_index not set"
            exit 1
        fi
        if [[ -z "$haplotypes" ]]; then
            echo "Error: haplotypes not set"
            exit 1
        fi
        if [[ -z "$sample_id" ]]; then
            echo "Error: sample_id not set"
            exit 1
        fi

        # Then run WASP command
        python /nas/longleaf/rhel8/apps/wasp/2023-02/WASP/mapping/find_intersecting_snps.py         --is_paired_end         --is_sorted         --output_dir output/wasp/filter_remapped_reads         --snp_tab $snp_tab         --snp_index $snp_index         --haplotype $haplotypes         --samples $sample_id         output/align/CQTL_AM7755_CTL_Ankle_replicate_RG.bam 2> output/logs/find_intersecting_snps_pbs_rep_CQTL_AM7755_CTL_Ankle_replicate.err

        
Submitted job 78 with external jobid '56371147'.
[Tue Dec 24 23:04:04 2024]
Error in rule find_intersecting_snps:
    jobid: 74
    output: output/wasp/filter_remapped_reads/CQTL_AM7778FE_CTL_Femur_1_filtered.remap.fq1.gz, output/wasp/filter_remapped_reads/CQTL_AM7778FE_CTL_Femur_1_filtered.remap.fq2.gz, output/wasp/filter_remapped_reads/CQTL_AM7778FE_CTL_Femur_1_filtered.to.remap.bam, output/wasp/filter_remapped_reads/CQTL_AM7778FE_CTL_Femur_1_filtered.keep.bam
    log: output/logs/find_intersecting_snps_pbs_rep_CQTL_AM7778FE_CTL_Femur_1.err (check log file(s) for error message)
    shell:
        
        module add wasp/2023-02

        mkdir -p output/wasp/filter_remapped_reads

                if [[ "CQTL_AM7778FE_CTL_Femur_1" == *"CTL"* ]]; then
            snp_tab=output/wasp/pbs_rep/snp_tab.h5
            snp_index=output/wasp/pbs_rep/snp_index.h5
            haplotypes=output/wasp/pbs_rep/haplotypes.h5
            sample_id=output/wasp/pbs_subset_sample_ids.txt
        elif [[ "CQTL_AM7778FE_CTL_Femur_1" == *"FNF"* ]]; then
            snp_tab=output/wasp/fnf_rep/snp_tab.h5
            snp_index=output/wasp/fnf_rep/snp_index.h5
            haplotypes=output/wasp/fnf_rep/haplotypes.h5
            sample_id=output/wasp/fnf_subset_sample_ids.txt
        else
            echo "Error: Sample type not recognized in CQTL_AM7778FE_CTL_Femur_1"
            exit 1
        fi

        # Add error checking here
        if [[ -z "$snp_tab" ]]; then
            echo "Error: snp_tab not set"
            exit 1
        fi
        if [[ -z "$snp_index" ]]; then
            echo "Error: snp_index not set"
            exit 1
        fi
        if [[ -z "$haplotypes" ]]; then
            echo "Error: haplotypes not set"
            exit 1
        fi
        if [[ -z "$sample_id" ]]; then
            echo "Error: sample_id not set"
            exit 1
        fi

        # Then run WASP command
        python /nas/longleaf/rhel8/apps/wasp/2023-02/WASP/mapping/find_intersecting_snps.py         --is_paired_end         --is_sorted         --output_dir output/wasp/filter_remapped_reads         --snp_tab $snp_tab         --snp_index $snp_index         --haplotype $haplotypes         --samples $sample_id         output/align/CQTL_AM7778FE_CTL_Femur_1_RG.bam 2> output/logs/find_intersecting_snps_pbs_rep_CQTL_AM7778FE_CTL_Femur_1.err

        
        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)
    cluster_jobid: 56371144

Error executing rule find_intersecting_snps on cluster (jobid: 74, external: 56371144, jobscript: /work/users/s/e/seyoun/CQTL_AI/.snakemake/tmp.5o37pd6b/snakejob.find_intersecting_snps.74.sh). For error details see the cluster log and the log files of the involved rule(s).
[Wed Dec 25 00:45:16 2024]
Error in rule find_intersecting_snps:
    jobid: 68
    output: output/wasp/filter_remapped_reads/CQTL_AM7778FE_FNF_Femur_1_filtered.remap.fq1.gz, output/wasp/filter_remapped_reads/CQTL_AM7778FE_FNF_Femur_1_filtered.remap.fq2.gz, output/wasp/filter_remapped_reads/CQTL_AM7778FE_FNF_Femur_1_filtered.to.remap.bam, output/wasp/filter_remapped_reads/CQTL_AM7778FE_FNF_Femur_1_filtered.keep.bam
    log: output/logs/find_intersecting_snps_pbs_rep_CQTL_AM7778FE_FNF_Femur_1.err (check log file(s) for error message)
    shell:
        
        module add wasp/2023-02

        mkdir -p output/wasp/filter_remapped_reads

                if [[ "CQTL_AM7778FE_FNF_Femur_1" == *"CTL"* ]]; then
            snp_tab=output/wasp/pbs_rep/snp_tab.h5
            snp_index=output/wasp/pbs_rep/snp_index.h5
            haplotypes=output/wasp/pbs_rep/haplotypes.h5
            sample_id=output/wasp/pbs_subset_sample_ids.txt
        elif [[ "CQTL_AM7778FE_FNF_Femur_1" == *"FNF"* ]]; then
            snp_tab=output/wasp/fnf_rep/snp_tab.h5
            snp_index=output/wasp/fnf_rep/snp_index.h5
            haplotypes=output/wasp/fnf_rep/haplotypes.h5
            sample_id=output/wasp/fnf_subset_sample_ids.txt
        else
            echo "Error: Sample type not recognized in CQTL_AM7778FE_FNF_Femur_1"
            exit 1
        fi

        # Add error checking here
        if [[ -z "$snp_tab" ]]; then
            echo "Error: snp_tab not set"
            exit 1
        fi
        if [[ -z "$snp_index" ]]; then
            echo "Error: snp_index not set"
            exit 1
        fi
        if [[ -z "$haplotypes" ]]; then
            echo "Error: haplotypes not set"
            exit 1
        fi
        if [[ -z "$sample_id" ]]; then
            echo "Error: sample_id not set"
            exit 1
        fi

        # Then run WASP command
        python /nas/longleaf/rhel8/apps/wasp/2023-02/WASP/mapping/find_intersecting_snps.py         --is_paired_end         --is_sorted         --output_dir output/wasp/filter_remapped_reads         --snp_tab $snp_tab         --snp_index $snp_index         --haplotype $haplotypes         --samples $sample_id         output/align/CQTL_AM7778FE_FNF_Femur_1_RG.bam 2> output/logs/find_intersecting_snps_pbs_rep_CQTL_AM7778FE_FNF_Femur_1.err

        
        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)
    cluster_jobid: 56371145

Error executing rule find_intersecting_snps on cluster (jobid: 68, external: 56371145, jobscript: /work/users/s/e/seyoun/CQTL_AI/.snakemake/tmp.5o37pd6b/snakejob.find_intersecting_snps.68.sh). For error details see the cluster log and the log files of the involved rule(s).
[Wed Dec 25 01:07:20 2024]
Error in rule find_intersecting_snps:
    jobid: 78
    output: output/wasp/filter_remapped_reads/CQTL_AM7755_CTL_Ankle_replicate_filtered.remap.fq1.gz, output/wasp/filter_remapped_reads/CQTL_AM7755_CTL_Ankle_replicate_filtered.remap.fq2.gz, output/wasp/filter_remapped_reads/CQTL_AM7755_CTL_Ankle_replicate_filtered.to.remap.bam, output/wasp/filter_remapped_reads/CQTL_AM7755_CTL_Ankle_replicate_filtered.keep.bam
    log: output/logs/find_intersecting_snps_pbs_rep_CQTL_AM7755_CTL_Ankle_replicate.err (check log file(s) for error message)
    shell:
        
        module add wasp/2023-02

        mkdir -p output/wasp/filter_remapped_reads

                if [[ "CQTL_AM7755_CTL_Ankle_replicate" == *"CTL"* ]]; then
            snp_tab=output/wasp/pbs_rep/snp_tab.h5
            snp_index=output/wasp/pbs_rep/snp_index.h5
            haplotypes=output/wasp/pbs_rep/haplotypes.h5
            sample_id=output/wasp/pbs_subset_sample_ids.txt
        elif [[ "CQTL_AM7755_CTL_Ankle_replicate" == *"FNF"* ]]; then
            snp_tab=output/wasp/fnf_rep/snp_tab.h5
            snp_index=output/wasp/fnf_rep/snp_index.h5
            haplotypes=output/wasp/fnf_rep/haplotypes.h5
            sample_id=output/wasp/fnf_subset_sample_ids.txt
        else
            echo "Error: Sample type not recognized in CQTL_AM7755_CTL_Ankle_replicate"
            exit 1
        fi

        # Add error checking here
        if [[ -z "$snp_tab" ]]; then
            echo "Error: snp_tab not set"
            exit 1
        fi
        if [[ -z "$snp_index" ]]; then
            echo "Error: snp_index not set"
            exit 1
        fi
        if [[ -z "$haplotypes" ]]; then
            echo "Error: haplotypes not set"
            exit 1
        fi
        if [[ -z "$sample_id" ]]; then
            echo "Error: sample_id not set"
            exit 1
        fi

        # Then run WASP command
        python /nas/longleaf/rhel8/apps/wasp/2023-02/WASP/mapping/find_intersecting_snps.py         --is_paired_end         --is_sorted         --output_dir output/wasp/filter_remapped_reads         --snp_tab $snp_tab         --snp_index $snp_index         --haplotype $haplotypes         --samples $sample_id         output/align/CQTL_AM7755_CTL_Ankle_replicate_RG.bam 2> output/logs/find_intersecting_snps_pbs_rep_CQTL_AM7755_CTL_Ankle_replicate.err

        
        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)
    cluster_jobid: 56371147

Error executing rule find_intersecting_snps on cluster (jobid: 78, external: 56371147, jobscript: /work/users/s/e/seyoun/CQTL_AI/.snakemake/tmp.5o37pd6b/snakejob.find_intersecting_snps.78.sh). For error details see the cluster log and the log files of the involved rule(s).
[Wed Dec 25 02:06:37 2024]
Error in rule find_intersecting_snps:
    jobid: 70
    output: output/wasp/filter_remapped_reads/CQTL_AM7754_FNF_Ankle_replicate_filtered.remap.fq1.gz, output/wasp/filter_remapped_reads/CQTL_AM7754_FNF_Ankle_replicate_filtered.remap.fq2.gz, output/wasp/filter_remapped_reads/CQTL_AM7754_FNF_Ankle_replicate_filtered.to.remap.bam, output/wasp/filter_remapped_reads/CQTL_AM7754_FNF_Ankle_replicate_filtered.keep.bam
    log: output/logs/find_intersecting_snps_pbs_rep_CQTL_AM7754_FNF_Ankle_replicate.err (check log file(s) for error message)
    shell:
        
        module add wasp/2023-02

        mkdir -p output/wasp/filter_remapped_reads

                if [[ "CQTL_AM7754_FNF_Ankle_replicate" == *"CTL"* ]]; then
            snp_tab=output/wasp/pbs_rep/snp_tab.h5
            snp_index=output/wasp/pbs_rep/snp_index.h5
            haplotypes=output/wasp/pbs_rep/haplotypes.h5
            sample_id=output/wasp/pbs_subset_sample_ids.txt
        elif [[ "CQTL_AM7754_FNF_Ankle_replicate" == *"FNF"* ]]; then
            snp_tab=output/wasp/fnf_rep/snp_tab.h5
            snp_index=output/wasp/fnf_rep/snp_index.h5
            haplotypes=output/wasp/fnf_rep/haplotypes.h5
            sample_id=output/wasp/fnf_subset_sample_ids.txt
        else
            echo "Error: Sample type not recognized in CQTL_AM7754_FNF_Ankle_replicate"
            exit 1
        fi

        # Add error checking here
        if [[ -z "$snp_tab" ]]; then
            echo "Error: snp_tab not set"
            exit 1
        fi
        if [[ -z "$snp_index" ]]; then
            echo "Error: snp_index not set"
            exit 1
        fi
        if [[ -z "$haplotypes" ]]; then
            echo "Error: haplotypes not set"
            exit 1
        fi
        if [[ -z "$sample_id" ]]; then
            echo "Error: sample_id not set"
            exit 1
        fi

        # Then run WASP command
        python /nas/longleaf/rhel8/apps/wasp/2023-02/WASP/mapping/find_intersecting_snps.py         --is_paired_end         --is_sorted         --output_dir output/wasp/filter_remapped_reads         --snp_tab $snp_tab         --snp_index $snp_index         --haplotype $haplotypes         --samples $sample_id         output/align/CQTL_AM7754_FNF_Ankle_replicate_RG.bam 2> output/logs/find_intersecting_snps_pbs_rep_CQTL_AM7754_FNF_Ankle_replicate.err

        
        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)
    cluster_jobid: 56371142

Error executing rule find_intersecting_snps on cluster (jobid: 70, external: 56371142, jobscript: /work/users/s/e/seyoun/CQTL_AI/.snakemake/tmp.5o37pd6b/snakejob.find_intersecting_snps.70.sh). For error details see the cluster log and the log files of the involved rule(s).
[Wed Dec 25 02:55:23 2024]
Error in rule find_intersecting_snps:
    jobid: 76
    output: output/wasp/filter_remapped_reads/CQTL_AM7754_CTL_Ankle_replicate_filtered.remap.fq1.gz, output/wasp/filter_remapped_reads/CQTL_AM7754_CTL_Ankle_replicate_filtered.remap.fq2.gz, output/wasp/filter_remapped_reads/CQTL_AM7754_CTL_Ankle_replicate_filtered.to.remap.bam, output/wasp/filter_remapped_reads/CQTL_AM7754_CTL_Ankle_replicate_filtered.keep.bam
    log: output/logs/find_intersecting_snps_pbs_rep_CQTL_AM7754_CTL_Ankle_replicate.err (check log file(s) for error message)
    shell:
        
        module add wasp/2023-02

        mkdir -p output/wasp/filter_remapped_reads

                if [[ "CQTL_AM7754_CTL_Ankle_replicate" == *"CTL"* ]]; then
            snp_tab=output/wasp/pbs_rep/snp_tab.h5
            snp_index=output/wasp/pbs_rep/snp_index.h5
            haplotypes=output/wasp/pbs_rep/haplotypes.h5
            sample_id=output/wasp/pbs_subset_sample_ids.txt
        elif [[ "CQTL_AM7754_CTL_Ankle_replicate" == *"FNF"* ]]; then
            snp_tab=output/wasp/fnf_rep/snp_tab.h5
            snp_index=output/wasp/fnf_rep/snp_index.h5
            haplotypes=output/wasp/fnf_rep/haplotypes.h5
            sample_id=output/wasp/fnf_subset_sample_ids.txt
        else
            echo "Error: Sample type not recognized in CQTL_AM7754_CTL_Ankle_replicate"
            exit 1
        fi

        # Add error checking here
        if [[ -z "$snp_tab" ]]; then
            echo "Error: snp_tab not set"
            exit 1
        fi
        if [[ -z "$snp_index" ]]; then
            echo "Error: snp_index not set"
            exit 1
        fi
        if [[ -z "$haplotypes" ]]; then
            echo "Error: haplotypes not set"
            exit 1
        fi
        if [[ -z "$sample_id" ]]; then
            echo "Error: sample_id not set"
            exit 1
        fi

        # Then run WASP command
        python /nas/longleaf/rhel8/apps/wasp/2023-02/WASP/mapping/find_intersecting_snps.py         --is_paired_end         --is_sorted         --output_dir output/wasp/filter_remapped_reads         --snp_tab $snp_tab         --snp_index $snp_index         --haplotype $haplotypes         --samples $sample_id         output/align/CQTL_AM7754_CTL_Ankle_replicate_RG.bam 2> output/logs/find_intersecting_snps_pbs_rep_CQTL_AM7754_CTL_Ankle_replicate.err

        
        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)
    cluster_jobid: 56371146

Error executing rule find_intersecting_snps on cluster (jobid: 76, external: 56371146, jobscript: /work/users/s/e/seyoun/CQTL_AI/.snakemake/tmp.5o37pd6b/snakejob.find_intersecting_snps.76.sh). For error details see the cluster log and the log files of the involved rule(s).
[Wed Dec 25 03:00:11 2024]
Error in rule find_intersecting_snps:
    jobid: 72
    output: output/wasp/filter_remapped_reads/CQTL_AM7755_FNF_Ankle_replicate_filtered.remap.fq1.gz, output/wasp/filter_remapped_reads/CQTL_AM7755_FNF_Ankle_replicate_filtered.remap.fq2.gz, output/wasp/filter_remapped_reads/CQTL_AM7755_FNF_Ankle_replicate_filtered.to.remap.bam, output/wasp/filter_remapped_reads/CQTL_AM7755_FNF_Ankle_replicate_filtered.keep.bam
    log: output/logs/find_intersecting_snps_pbs_rep_CQTL_AM7755_FNF_Ankle_replicate.err (check log file(s) for error message)
    shell:
        
        module add wasp/2023-02

        mkdir -p output/wasp/filter_remapped_reads

                if [[ "CQTL_AM7755_FNF_Ankle_replicate" == *"CTL"* ]]; then
            snp_tab=output/wasp/pbs_rep/snp_tab.h5
            snp_index=output/wasp/pbs_rep/snp_index.h5
            haplotypes=output/wasp/pbs_rep/haplotypes.h5
            sample_id=output/wasp/pbs_subset_sample_ids.txt
        elif [[ "CQTL_AM7755_FNF_Ankle_replicate" == *"FNF"* ]]; then
            snp_tab=output/wasp/fnf_rep/snp_tab.h5
            snp_index=output/wasp/fnf_rep/snp_index.h5
            haplotypes=output/wasp/fnf_rep/haplotypes.h5
            sample_id=output/wasp/fnf_subset_sample_ids.txt
        else
            echo "Error: Sample type not recognized in CQTL_AM7755_FNF_Ankle_replicate"
            exit 1
        fi

        # Add error checking here
        if [[ -z "$snp_tab" ]]; then
            echo "Error: snp_tab not set"
            exit 1
        fi
        if [[ -z "$snp_index" ]]; then
            echo "Error: snp_index not set"
            exit 1
        fi
        if [[ -z "$haplotypes" ]]; then
            echo "Error: haplotypes not set"
            exit 1
        fi
        if [[ -z "$sample_id" ]]; then
            echo "Error: sample_id not set"
            exit 1
        fi

        # Then run WASP command
        python /nas/longleaf/rhel8/apps/wasp/2023-02/WASP/mapping/find_intersecting_snps.py         --is_paired_end         --is_sorted         --output_dir output/wasp/filter_remapped_reads         --snp_tab $snp_tab         --snp_index $snp_index         --haplotype $haplotypes         --samples $sample_id         output/align/CQTL_AM7755_FNF_Ankle_replicate_RG.bam 2> output/logs/find_intersecting_snps_pbs_rep_CQTL_AM7755_FNF_Ankle_replicate.err

        
        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)
    cluster_jobid: 56371143

Error executing rule find_intersecting_snps on cluster (jobid: 72, external: 56371143, jobscript: /work/users/s/e/seyoun/CQTL_AI/.snakemake/tmp.5o37pd6b/snakejob.find_intersecting_snps.72.sh). For error details see the cluster log and the log files of the involved rule(s).
Shutting down, this might take some time.
Exiting because a job execution failed. Look above for error message
Complete log: /work/users/s/e/seyoun/CQTL_AI/.snakemake/log/2024-12-24T161643.578554.snakemake.log
