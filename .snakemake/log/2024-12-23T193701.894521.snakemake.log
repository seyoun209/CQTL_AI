Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cluster nodes: 150
Job counts:
	count	jobs
	1	all
	1	create_count_matrices
	1	hmmratac_merge_peaks_by_condition
	3

[Mon Dec 23 19:37:02 2024]
rule create_count_matrices:
    input: output/peaks/synovium/merged/all_macs3_merged.bed, output/peaks/synovium/merged/all_macs2_merged.bed, output/peaks/synovium/merged/all_hmmratac_merged.bed, /work/users/s/e/seyoun/CQTL_AI/output/align/FACT_23-0013_CTL_synovium_1_RG.bam, /work/users/s/e/seyoun/CQTL_AI/output/align/FACT_23-0013_FNF_synovium_1_RG.bam, /work/users/s/e/seyoun/CQTL_AI/output/align/FACT_23-0016_CTL_synovium_1_RG.bam, /work/users/s/e/seyoun/CQTL_AI/output/align/FACT_23-0016_FNF_synovium_1_RG.bam, /work/users/s/e/seyoun/CQTL_AI/output/align/FACT_23-0022_CTL_synovium_1_RG.bam, /work/users/s/e/seyoun/CQTL_AI/output/align/FACT_23-0022_FNF_synovium_1_RG.bam, /work/users/s/e/seyoun/CQTL_AI/output/align/FACT_23-0023_CTL_synovium_1_RG.bam, /work/users/s/e/seyoun/CQTL_AI/output/align/FACT_23-0023_FNF_synovium_1_RG.bam, /work/users/s/e/seyoun/CQTL_AI/output/align/FACT_23-0025_CTL_synovium_1_RG.bam, /work/users/s/e/seyoun/CQTL_AI/output/align/FACT_23-0025_FNF_synovium_1_RG.bam
    output: output/peaks/synovium/counts/macs3.saf, output/peaks/synovium/counts/macs2.saf, output/peaks/synovium/counts/hhmratac.saf, output/peaks/synovium/counts/macs3_counts.txt, output/peaks/synovium/counts/macs2_counts.txt, output/peaks/synovium/counts/hmmratac_counts.txt
    log: output/logs/synovium_count_matrices.err, output/logs/synovium_count_matrices.out
    jobid: 38
    wildcards: tissue=synovium
    threads: 8


        module load subread/2.0.6
        mkdir -p output/peaks/synovium/counts

        # MACS3
        awk 'BEGIN{print "GeneID	Chr	Start	End	Strand"}
             {print "peak_"NR"	"$1"	"$2"	"$3"	+"}' output/peaks/synovium/merged/all_macs3_merged.bed > output/peaks/synovium/counts/macs3.saf
        featureCounts -p -T 8 -F SAF -a output/peaks/synovium/counts/macs3.saf -o output/peaks/synovium/counts/macs3_counts.txt /work/users/s/e/seyoun/CQTL_AI/output/align/FACT_23-0013_CTL_synovium_1_RG.bam /work/users/s/e/seyoun/CQTL_AI/output/align/FACT_23-0013_FNF_synovium_1_RG.bam /work/users/s/e/seyoun/CQTL_AI/output/align/FACT_23-0016_CTL_synovium_1_RG.bam /work/users/s/e/seyoun/CQTL_AI/output/align/FACT_23-0016_FNF_synovium_1_RG.bam /work/users/s/e/seyoun/CQTL_AI/output/align/FACT_23-0022_CTL_synovium_1_RG.bam /work/users/s/e/seyoun/CQTL_AI/output/align/FACT_23-0022_FNF_synovium_1_RG.bam /work/users/s/e/seyoun/CQTL_AI/output/align/FACT_23-0023_CTL_synovium_1_RG.bam /work/users/s/e/seyoun/CQTL_AI/output/align/FACT_23-0023_FNF_synovium_1_RG.bam /work/users/s/e/seyoun/CQTL_AI/output/align/FACT_23-0025_CTL_synovium_1_RG.bam /work/users/s/e/seyoun/CQTL_AI/output/align/FACT_23-0025_FNF_synovium_1_RG.bam 2>> output/logs/synovium_count_matrices.err

        # MACS2
        awk 'BEGIN{print "GeneID	Chr	Start	End	Strand"}
             {print "peak_"NR"	"$1"	"$2"	"$3"	+"}' output/peaks/synovium/merged/all_macs2_merged.bed > output/peaks/synovium/counts/macs2.saf
        featureCounts -p -T 8 -F SAF -a output/peaks/synovium/counts/macs2.saf -o output/peaks/synovium/counts/macs2_counts.txt /work/users/s/e/seyoun/CQTL_AI/output/align/FACT_23-0013_CTL_synovium_1_RG.bam /work/users/s/e/seyoun/CQTL_AI/output/align/FACT_23-0013_FNF_synovium_1_RG.bam /work/users/s/e/seyoun/CQTL_AI/output/align/FACT_23-0016_CTL_synovium_1_RG.bam /work/users/s/e/seyoun/CQTL_AI/output/align/FACT_23-0016_FNF_synovium_1_RG.bam /work/users/s/e/seyoun/CQTL_AI/output/align/FACT_23-0022_CTL_synovium_1_RG.bam /work/users/s/e/seyoun/CQTL_AI/output/align/FACT_23-0022_FNF_synovium_1_RG.bam /work/users/s/e/seyoun/CQTL_AI/output/align/FACT_23-0023_CTL_synovium_1_RG.bam /work/users/s/e/seyoun/CQTL_AI/output/align/FACT_23-0023_FNF_synovium_1_RG.bam /work/users/s/e/seyoun/CQTL_AI/output/align/FACT_23-0025_CTL_synovium_1_RG.bam /work/users/s/e/seyoun/CQTL_AI/output/align/FACT_23-0025_FNF_synovium_1_RG.bam 2>> output/logs/synovium_count_matrices.err

        # HMMRATAC
        awk 'BEGIN{print "GeneID	Chr	Start	End	Strand"}
             {print "peak_"NR"	"$1"	"$2"	"$3"	+"}' output/peaks/synovium/merged/all_hmmratac_merged.bed > output/peaks/synovium/counts/hhmratac.saf
        featureCounts -p -T 8 -F SAF -a output/peaks/synovium/counts/hhmratac.saf -o output/peaks/synovium/counts/hmmratac_counts.txt /work/users/s/e/seyoun/CQTL_AI/output/align/FACT_23-0013_CTL_synovium_1_RG.bam /work/users/s/e/seyoun/CQTL_AI/output/align/FACT_23-0013_FNF_synovium_1_RG.bam /work/users/s/e/seyoun/CQTL_AI/output/align/FACT_23-0016_CTL_synovium_1_RG.bam /work/users/s/e/seyoun/CQTL_AI/output/align/FACT_23-0016_FNF_synovium_1_RG.bam /work/users/s/e/seyoun/CQTL_AI/output/align/FACT_23-0022_CTL_synovium_1_RG.bam /work/users/s/e/seyoun/CQTL_AI/output/align/FACT_23-0022_FNF_synovium_1_RG.bam /work/users/s/e/seyoun/CQTL_AI/output/align/FACT_23-0023_CTL_synovium_1_RG.bam /work/users/s/e/seyoun/CQTL_AI/output/align/FACT_23-0023_FNF_synovium_1_RG.bam /work/users/s/e/seyoun/CQTL_AI/output/align/FACT_23-0025_CTL_synovium_1_RG.bam /work/users/s/e/seyoun/CQTL_AI/output/align/FACT_23-0025_FNF_synovium_1_RG.bam 2>> output/logs/synovium_count_matrices.err
        
Submitted job 38 with external jobid '56323929'.

[Mon Dec 23 19:37:04 2024]
rule hmmratac_merge_peaks_by_condition:
    input: output/peaks/synovium/hmmratac/FACT_23-0013_FNF_synovium_1_accessible_regions.narrowPeak, output/peaks/synovium/hmmratac/FACT_23-0016_FNF_synovium_1_accessible_regions.narrowPeak, output/peaks/synovium/hmmratac/FACT_23-0022_FNF_synovium_1_accessible_regions.narrowPeak, output/peaks/synovium/hmmratac/FACT_23-0023_FNF_synovium_1_accessible_regions.narrowPeak, output/peaks/synovium/hmmratac/FACT_23-0025_FNF_synovium_1_accessible_regions.narrowPeak
    output: output/peaks/synovium/FNF_consensus_hmmratac_peaks.bed
    log: output/logs/synovium_hmmratac_merge_bedtools_FNF.err
    jobid: 34
    wildcards: tissue=synovium, cond=FNF


        module load bedtools/2.30

        mkdir -p output/peaks/synovium

        # Merge peaks that appear in at least 50% of samples
        multiIntersectBed -i output/peaks/synovium/hmmratac/FACT_23-0013_FNF_synovium_1_accessible_regions.narrowPeak output/peaks/synovium/hmmratac/FACT_23-0016_FNF_synovium_1_accessible_regions.narrowPeak output/peaks/synovium/hmmratac/FACT_23-0022_FNF_synovium_1_accessible_regions.narrowPeak output/peaks/synovium/hmmratac/FACT_23-0023_FNF_synovium_1_accessible_regions.narrowPeak output/peaks/synovium/hmmratac/FACT_23-0025_FNF_synovium_1_accessible_regions.narrowPeak |         awk -v min_samples=2 '$4 >= min_samples' |         bedtools merge > output/peaks/synovium/FNF_consensus_hmmratac_peaks.bed 2> output/logs/synovium_hmmratac_merge_bedtools_FNF.err
        
Submitted job 34 with external jobid '56323930'.
Waiting at most 500 seconds for missing files.
[Mon Dec 23 19:37:33 2024]
Finished job 34.
1 of 3 steps (33%) done
[Mon Dec 23 19:43:50 2024]
Finished job 38.
2 of 3 steps (67%) done

[Mon Dec 23 19:43:51 2024]
localrule all:
    input: output/peaks/synovium/macs2/FACT_23-0013_CTL_synovium_1_peaks.narrowPeak, output/peaks/synovium/macs2/FACT_23-0013_FNF_synovium_1_peaks.narrowPeak, output/peaks/synovium/macs2/FACT_23-0016_CTL_synovium_1_peaks.narrowPeak, output/peaks/synovium/macs2/FACT_23-0016_FNF_synovium_1_peaks.narrowPeak, output/peaks/synovium/macs2/FACT_23-0022_CTL_synovium_1_peaks.narrowPeak, output/peaks/synovium/macs2/FACT_23-0022_FNF_synovium_1_peaks.narrowPeak, output/peaks/synovium/macs2/FACT_23-0023_CTL_synovium_1_peaks.narrowPeak, output/peaks/synovium/macs2/FACT_23-0023_FNF_synovium_1_peaks.narrowPeak, output/peaks/synovium/macs2/FACT_23-0025_CTL_synovium_1_peaks.narrowPeak, output/peaks/synovium/macs2/FACT_23-0025_FNF_synovium_1_peaks.narrowPeak, output/peaks/synovium/macs3/FACT_23-0013_CTL_synovium_1_peaks.narrowPeak, output/peaks/synovium/macs3/FACT_23-0013_FNF_synovium_1_peaks.narrowPeak, output/peaks/synovium/macs3/FACT_23-0016_CTL_synovium_1_peaks.narrowPeak, output/peaks/synovium/macs3/FACT_23-0016_FNF_synovium_1_peaks.narrowPeak, output/peaks/synovium/macs3/FACT_23-0022_CTL_synovium_1_peaks.narrowPeak, output/peaks/synovium/macs3/FACT_23-0022_FNF_synovium_1_peaks.narrowPeak, output/peaks/synovium/macs3/FACT_23-0023_CTL_synovium_1_peaks.narrowPeak, output/peaks/synovium/macs3/FACT_23-0023_FNF_synovium_1_peaks.narrowPeak, output/peaks/synovium/macs3/FACT_23-0025_CTL_synovium_1_peaks.narrowPeak, output/peaks/synovium/macs3/FACT_23-0025_FNF_synovium_1_peaks.narrowPeak, output/peaks/synovium/hmmratac/FACT_23-0013_CTL_synovium_1_accessible_regions.narrowPeak, output/peaks/synovium/hmmratac/FACT_23-0013_FNF_synovium_1_accessible_regions.narrowPeak, output/peaks/synovium/hmmratac/FACT_23-0016_CTL_synovium_1_accessible_regions.narrowPeak, output/peaks/synovium/hmmratac/FACT_23-0016_FNF_synovium_1_accessible_regions.narrowPeak, output/peaks/synovium/hmmratac/FACT_23-0022_CTL_synovium_1_accessible_regions.narrowPeak, output/peaks/synovium/hmmratac/FACT_23-0022_FNF_synovium_1_accessible_regions.narrowPeak, output/peaks/synovium/hmmratac/FACT_23-0023_CTL_synovium_1_accessible_regions.narrowPeak, output/peaks/synovium/hmmratac/FACT_23-0023_FNF_synovium_1_accessible_regions.narrowPeak, output/peaks/synovium/hmmratac/FACT_23-0025_CTL_synovium_1_accessible_regions.narrowPeak, output/peaks/synovium/hmmratac/FACT_23-0025_FNF_synovium_1_accessible_regions.narrowPeak, output/peaks/synovium/CTL_consensus_macs3_peaks.bed, output/peaks/synovium/FNF_consensus_macs3_peaks.bed, output/peaks/synovium/CTL_consensus_hmmratac_peaks.bed, output/peaks/synovium/FNF_consensus_hmmratac_peaks.bed, output/peaks/synovium/CTL_consensus_macs2_peaks.bed, output/peaks/synovium/FNF_consensus_macs2_peaks.bed, output/peaks/synovium/merged/all_macs3_merged.bed, output/peaks/synovium/merged/all_macs2_merged.bed, output/peaks/synovium/merged/all_hmmratac_merged.bed, output/peaks/synovium/counts/macs3.saf, output/peaks/synovium/counts/macs2.saf, output/peaks/synovium/counts/hhmratac.saf, output/peaks/synovium/counts/macs3_counts.txt, output/peaks/synovium/counts/macs2_counts.txt, output/peaks/synovium/counts/hmmratac_counts.txt
    jobid: 0

[Mon Dec 23 19:43:51 2024]
Finished job 0.
3 of 3 steps (100%) done
Complete log: /work/users/s/e/seyoun/CQTL_AI/.snakemake/log/2024-12-23T193701.894521.snakemake.log
